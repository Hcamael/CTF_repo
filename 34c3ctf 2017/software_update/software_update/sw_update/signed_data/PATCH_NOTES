* fixed lots of bugs, to ashamed to put details here.

